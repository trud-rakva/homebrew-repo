diff --git a/src/rs1.c b/src/rs1.c
index 37aa9f07..134068b1 100644
--- a/src/rs1.c
+++ b/src/rs1.c
@@ -9,7 +9,7 @@
 
 #include "fido.h"
 
-#if defined(LIBRESSL_VERSION_NUMBER)
+#if defined(LIBRESSL_VERSION_NUMBER) && LIBRESSL_VERSION_NUMBER < 0x3050200fL
 static EVP_MD *
 rs1_get_EVP_MD(void)
 {
diff --git a/src/rs256.c b/src/rs256.c
index 29fcedbd..5ef71ae0 100644
--- a/src/rs256.c
+++ b/src/rs256.c
@@ -11,7 +11,7 @@
 #include "fido.h"
 #include "fido/rs256.h"
 
-#if defined(LIBRESSL_VERSION_NUMBER)
+#if defined(LIBRESSL_VERSION_NUMBER) && LIBRESSL_VERSION_NUMBER < 0x3050200fL
 static EVP_MD *
 rs256_get_EVP_MD(void)
 {
